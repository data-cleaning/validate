<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Rules from SDMX | The Data Validation Cookbook</title>
  <meta name="description" content="Chapter 9 Rules from SDMX | The Data Validation Cookbook" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Rules from SDMX | The Data Validation Cookbook" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Rules from SDMX | The Data Validation Cookbook" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sect-rulefiles.html"/>
<link rel="next" href="sect-comparing.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Validation Cookbook</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#citing-this-work"><i class="fa fa-check"></i>Citing this work</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i>Contributing</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="sect-intro.html"><a href="sect-intro.html"><i class="fa fa-check"></i><b>1</b> Introduction to validate</a><ul>
<li class="chapter" data-level="1.1" data-path="sect-intro.html"><a href="sect-intro.html#a-quick-example"><i class="fa fa-check"></i><b>1.1</b> A quick example</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="sect-varlevelchecks.html"><a href="sect-varlevelchecks.html"><i class="fa fa-check"></i><b>2</b> Variable checks</a><ul>
<li class="chapter" data-level="2.1" data-path="sect-varlevelchecks.html"><a href="sect-varlevelchecks.html#variable-type"><i class="fa fa-check"></i><b>2.1</b> Variable type</a></li>
<li class="chapter" data-level="2.2" data-path="sect-varlevelchecks.html"><a href="sect-varlevelchecks.html#sect:missingness"><i class="fa fa-check"></i><b>2.2</b> Missingness</a></li>
<li class="chapter" data-level="2.3" data-path="sect-varlevelchecks.html"><a href="sect-varlevelchecks.html#field-length"><i class="fa fa-check"></i><b>2.3</b> Field length</a></li>
<li class="chapter" data-level="2.4" data-path="sect-varlevelchecks.html"><a href="sect-varlevelchecks.html#format-of-numeric-fields"><i class="fa fa-check"></i><b>2.4</b> Format of numeric fields</a></li>
<li class="chapter" data-level="2.5" data-path="sect-varlevelchecks.html"><a href="sect-varlevelchecks.html#general-field-format"><i class="fa fa-check"></i><b>2.5</b> General field format</a></li>
<li class="chapter" data-level="2.6" data-path="sect-varlevelchecks.html"><a href="sect-varlevelchecks.html#numeric-ranges"><i class="fa fa-check"></i><b>2.6</b> Numeric ranges</a></li>
<li class="chapter" data-level="2.7" data-path="sect-varlevelchecks.html"><a href="sect-varlevelchecks.html#ranges-for-times-and-periods"><i class="fa fa-check"></i><b>2.7</b> Ranges for times and periods</a></li>
<li class="chapter" data-level="2.8" data-path="sect-varlevelchecks.html"><a href="sect-varlevelchecks.html#code-lists"><i class="fa fa-check"></i><b>2.8</b> Code lists</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sect-availableunique.html"><a href="sect-availableunique.html"><i class="fa fa-check"></i><b>3</b> Availability and uniqueness</a><ul>
<li class="chapter" data-level="3.1" data-path="sect-availableunique.html"><a href="sect-availableunique.html#long-data"><i class="fa fa-check"></i><b>3.1</b> Long data</a></li>
<li class="chapter" data-level="3.2" data-path="sect-availableunique.html"><a href="sect-availableunique.html#sect:uniqueness"><i class="fa fa-check"></i><b>3.2</b> Uniqueness</a></li>
<li class="chapter" data-level="3.3" data-path="sect-availableunique.html"><a href="sect-availableunique.html#sect:completeness"><i class="fa fa-check"></i><b>3.3</b> Availability of records</a></li>
<li class="chapter" data-level="3.4" data-path="sect-availableunique.html"><a href="sect-availableunique.html#gaps-in-time-series"><i class="fa fa-check"></i><b>3.4</b> Gaps in (time) series</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multivariate-checks.html"><a href="multivariate-checks.html"><i class="fa fa-check"></i><b>4</b> Multivariate checks</a><ul>
<li class="chapter" data-level="4.1" data-path="multivariate-checks.html"><a href="multivariate-checks.html#sect:iscomplete"><i class="fa fa-check"></i><b>4.1</b> Completeness of records</a></li>
<li class="chapter" data-level="4.2" data-path="multivariate-checks.html"><a href="multivariate-checks.html#balance-equalities-and-inequalities"><i class="fa fa-check"></i><b>4.2</b> Balance equalities and inequalities</a></li>
<li class="chapter" data-level="4.3" data-path="multivariate-checks.html"><a href="multivariate-checks.html#conditional-restrictions"><i class="fa fa-check"></i><b>4.3</b> Conditional restrictions</a></li>
<li class="chapter" data-level="4.4" data-path="multivariate-checks.html"><a href="multivariate-checks.html#forbidden-value-combinations"><i class="fa fa-check"></i><b>4.4</b> Forbidden value combinations</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sect-statisticalchecks.html"><a href="sect-statisticalchecks.html"><i class="fa fa-check"></i><b>5</b> Statistical checks</a><ul>
<li class="chapter" data-level="5.1" data-path="sect-statisticalchecks.html"><a href="sect-statisticalchecks.html#sect:groupwise"><i class="fa fa-check"></i><b>5.1</b> Statistical and groupwise characteristics</a></li>
<li class="chapter" data-level="5.2" data-path="sect-statisticalchecks.html"><a href="sect-statisticalchecks.html#group-properties"><i class="fa fa-check"></i><b>5.2</b> Group properties</a></li>
<li class="chapter" data-level="5.3" data-path="sect-statisticalchecks.html"><a href="sect-statisticalchecks.html#code-hierarchies-and-aggregation"><i class="fa fa-check"></i><b>5.3</b> Code hierarchies and aggregation</a></li>
<li class="chapter" data-level="5.4" data-path="sect-statisticalchecks.html"><a href="sect-statisticalchecks.html#general-aggregates-in-long-form-data"><i class="fa fa-check"></i><b>5.4</b> General aggregates in long-form data</a><ul>
<li class="chapter" data-level="" data-path="sect-statisticalchecks.html"><a href="sect-statisticalchecks.html#notes"><i class="fa fa-check"></i>Notes</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="sect-statisticalchecks.html"><a href="sect-statisticalchecks.html#aggregates-of-time-series-in-long-format"><i class="fa fa-check"></i><b>5.5</b> Aggregates of time series in long format</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sect-indicators.html"><a href="sect-indicators.html"><i class="fa fa-check"></i><b>6</b> Indicators</a><ul>
<li class="chapter" data-level="6.1" data-path="sect-indicators.html"><a href="sect-indicators.html#a-first-example"><i class="fa fa-check"></i><b>6.1</b> A first example</a></li>
<li class="chapter" data-level="6.2" data-path="sect-indicators.html"><a href="sect-indicators.html#getting-indicator-values"><i class="fa fa-check"></i><b>6.2</b> Getting indicator values</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sect-work.html"><a href="sect-work.html"><i class="fa fa-check"></i><b>7</b> Working with validate</a><ul>
<li class="chapter" data-level="7.1" data-path="sect-work.html"><a href="sect-work.html#sect:readfromfile"><i class="fa fa-check"></i><b>7.1</b> Reading rules from file</a></li>
<li class="chapter" data-level="7.2" data-path="sect-work.html"><a href="sect-work.html#manipulating-rule-sets"><i class="fa fa-check"></i><b>7.2</b> Manipulating rule sets</a></li>
<li class="chapter" data-level="7.3" data-path="sect-work.html"><a href="sect-work.html#rule-metadata"><i class="fa fa-check"></i><b>7.3</b> Rule metadata</a></li>
<li class="chapter" data-level="7.4" data-path="sect-work.html"><a href="sect-work.html#sect:yamlfiles"><i class="fa fa-check"></i><b>7.4</b> Metadata in text files: <code>YAML</code></a></li>
<li class="chapter" data-level="7.5" data-path="sect-work.html"><a href="sect-work.html#rules-in-data-frames"><i class="fa fa-check"></i><b>7.5</b> Rules in data frames</a></li>
<li class="chapter" data-level="7.6" data-path="sect-work.html"><a href="sect-work.html#sect:syntax"><i class="fa fa-check"></i><b>7.6</b> Validation rule syntax</a></li>
<li class="chapter" data-level="7.7" data-path="sect-work.html"><a href="sect-work.html#confrontation-objects"><i class="fa fa-check"></i><b>7.7</b> Confrontation objects</a></li>
<li class="chapter" data-level="7.8" data-path="sect-work.html"><a href="sect-work.html#sect:options"><i class="fa fa-check"></i><b>7.8</b> Confrontation options</a></li>
<li class="chapter" data-level="7.9" data-path="sect-work.html"><a href="sect-work.html#using-reference-data"><i class="fa fa-check"></i><b>7.9</b> Using reference data</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sect-rulefiles.html"><a href="sect-rulefiles.html"><i class="fa fa-check"></i><b>8</b> Rules in text files</a><ul>
<li class="chapter" data-level="8.1" data-path="sect-rulefiles.html"><a href="sect-rulefiles.html#setting-options"><i class="fa fa-check"></i><b>8.1</b> Setting options</a></li>
<li class="chapter" data-level="8.2" data-path="sect-rulefiles.html"><a href="sect-rulefiles.html#including-other-rule-files"><i class="fa fa-check"></i><b>8.2</b> Including other rule files</a></li>
<li class="chapter" data-level="8.3" data-path="sect-rulefiles.html"><a href="sect-rulefiles.html#exporting-validator-objects"><i class="fa fa-check"></i><b>8.3</b> Exporting validator objects</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="sect-sdmxrules.html"><a href="sect-sdmxrules.html"><i class="fa fa-check"></i><b>9</b> Rules from SDMX</a><ul>
<li class="chapter" data-level="9.1" data-path="sect-sdmxrules.html"><a href="sect-sdmxrules.html#sdmx-and-validate"><i class="fa fa-check"></i><b>9.1</b> SDMX and <code>validate</code></a></li>
<li class="chapter" data-level="9.2" data-path="sect-sdmxrules.html"><a href="sect-sdmxrules.html#sdmx-and-api-locations"><i class="fa fa-check"></i><b>9.2</b> SDMX and API locations</a></li>
<li class="chapter" data-level="9.3" data-path="sect-sdmxrules.html"><a href="sect-sdmxrules.html#code-lists-from-sdmx-registries"><i class="fa fa-check"></i><b>9.3</b> Code lists from SDMX registries</a></li>
<li class="chapter" data-level="9.4" data-path="sect-sdmxrules.html"><a href="sect-sdmxrules.html#derive-rules-from-dsd"><i class="fa fa-check"></i><b>9.4</b> Derive rules from DSD</a></li>
<li class="chapter" data-level="9.5" data-path="sect-sdmxrules.html"><a href="sect-sdmxrules.html#moresdmx"><i class="fa fa-check"></i><b>9.5</b> More on <code>SDMX</code></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sect-comparing.html"><a href="sect-comparing.html"><i class="fa fa-check"></i><b>10</b> Comparing data sets</a><ul>
<li class="chapter" data-level="10.1" data-path="sect-comparing.html"><a href="sect-comparing.html#cell-counts"><i class="fa fa-check"></i><b>10.1</b> Cell counts</a></li>
<li class="chapter" data-level="10.2" data-path="sect-comparing.html"><a href="sect-comparing.html#comparing-rule-violations"><i class="fa fa-check"></i><b>10.2</b> Comparing rule violations</a></li>
<li class="chapter" data-level="10.3" data-path="sect-comparing.html"><a href="sect-comparing.html#validate-and-lumberjack"><i class="fa fa-check"></i><b>10.3</b> <code>validate</code> and <code>lumberjack</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliographical-notes.html"><a href="bibliographical-notes.html"><i class="fa fa-check"></i>Bibliographical notes</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Data Validation Cookbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sect:sdmxrules" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Rules from SDMX</h1>
<p><strong>Note</strong> This functionality is available for <code>validate</code> versions <code>1.1.0</code> or higher.</p>
<p>In this Chapter we first demonstrate how to use SDMX with the <code>validate</code>
package. In <a href="sect-sdmxrules.html#moresdmx">9.5</a> we provide a bit more general information on the
SDMX landscape, registries, and available APIs.</p>
<div id="sdmx-and-validate" class="section level2">
<h2><span class="header-section-number">9.1</span> SDMX and <code>validate</code></h2>
<p>Statistical Data and Metadata eXchange, or SDMX is a standard for storing data
and the description of its structure, meaning, and content. The standard is
developed by the <a href="https://sdmx.org">SDMX consortium</a>. It is used, amongst
others, in the <a href="https://en.wikipedia.org/wiki/Official_statistics">Official Statistics</a> community to
exchange data in a standardized way.</p>
<p>A key aspect of SDMX is a standardized way to describe variables, data
structure (how is it stored), and code lists. This metadata is defined in an
<em>SDMX registry</em> where data producers can download or query the necessary
metadata. Alternatively, metadata is distributed in a so-called Data Structure
Definition (DSD) file, which is usually in
<a href="https://en.wikipedia.org/wiki/XML">XML</a> format.</p>
<p>For data validation, some aspects of the metadata are of interest. In
particular, code lists are interesting objects to test against. In validate
there are two ways to use SDMX codelists. The first is by referring to a
specific code list for a specific variable in an SDMX registry. The second way
is to derive a rule set from a DSD file that can be retrieved from a registry.</p>
<p>Below we discuss the follwing functions.</p>
<table>
<thead>
<tr class="header">
<th>function</th>
<th>what it does</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>sdmx_endpoint</code></td>
<td>retrieve URL for SDMX endpoint</td>
</tr>
<tr class="even">
<td><code>sdmx_codelist</code></td>
<td>retrieve sdmx codelist</td>
</tr>
<tr class="odd">
<td><code>estat_codelist</code></td>
<td>retrieve codelist from Eurostat SDMX registry</td>
</tr>
<tr class="even">
<td><code>global_codelist</code></td>
<td>retrieve codelist from Global SDMX registry</td>
</tr>
<tr class="odd">
<td><code>validator_from_dsd</code></td>
<td>derive validation rules from DSD in SDMX registry</td>
</tr>
</tbody>
</table>
</div>
<div id="sdmx-and-api-locations" class="section level2">
<h2><span class="header-section-number">9.2</span> SDMX and API locations</h2>
<p>SDMX metadata is typically exposed through a standardized REST API.
To query an SDMX registry, one needs to supply at least the following
information:</p>
<ul>
<li>The registry’s API entry point. This is the base URL for the online registry.
You can specify it literally, or use one of the helper functions that
are aware of certan known SDMX registries.</li>
<li>Agency ID: the ID of the agency that responsible for the code list</li>
<li>Resource IDL the name of the SDMX resource. This is usually the name of
a type of statistic, like STS (short term statistics)</li>
<li>version: the code list version.</li>
</ul>
<p>Some API endpoints are stored with the package. The function <code>sdmx_endpoint()</code>
returns endpoint URLs for several SDMX registries. Use</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb266-1" title="1"><span class="kw">sdmx_endpoint</span>()</a></code></pre></div>
<p>to get a list of valid endpoints. As an example, to retrieve the endpoint for the global
SDMX registry, use the following.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb267-1" title="1"><span class="kw">sdmx_endpoint</span>(<span class="dt">registry=</span><span class="st">&quot;global&quot;</span>)</a></code></pre></div>
<pre><code>##                                             GLOBAL 
## &quot;https://registry.sdmx.org/ws/public/sdmxapi/rest&quot;</code></pre>
</div>
<div id="code-lists-from-sdmx-registries" class="section level2">
<h2><span class="header-section-number">9.3</span> Code lists from SDMX registries</h2>
<p>Code lists can be retrieved on-the-fly from one of the online
SDMX registries. In the following rule we retrieve the codelist of economic activiteis
from the <a href="https://registry.sdmx.org/ws/public/sdmxapi">global SDMX registry</a>.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb269-1" title="1">codelist &lt;-<span class="st"> </span><span class="kw">sdmx_codelist</span>(</a>
<a class="sourceLine" id="cb269-2" title="2">  <span class="dt">endpoint =</span> <span class="kw">sdmx_endpoint</span>(<span class="st">&quot;global&quot;</span>)</a>
<a class="sourceLine" id="cb269-3" title="3">  , <span class="dt">agency_id =</span> <span class="st">&quot;ESTAT&quot;</span></a>
<a class="sourceLine" id="cb269-4" title="4">  , <span class="dt">resource_id =</span> <span class="st">&quot;CL_ACTIVITY&quot;</span>)</a>
<a class="sourceLine" id="cb269-5" title="5"></a>
<a class="sourceLine" id="cb269-6" title="6"><span class="kw">head</span>(codelist)</a>
<a class="sourceLine" id="cb269-7" title="7">[<span class="dv">1</span>] <span class="st">&quot;_T&quot;</span>  <span class="st">&quot;_X&quot;</span>  <span class="st">&quot;_Z&quot;</span>  <span class="st">&quot;A&quot;</span>   <span class="st">&quot;A_B&quot;</span> <span class="st">&quot;A01&quot;</span></a></code></pre></div>
<p>Equivalently, and as a convenience, you could use <code>global_codelist()</code> to avoid
specifying the API endpoint explicitly. The output can be used in a rule.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb270-1" title="1">Activity <span class="op">%in%</span><span class="st"> </span><span class="kw">global_codelist</span>(<span class="dt">agency_id=</span><span class="st">&quot;ESTAT&quot;</span>, <span class="dt">resource_id=</span><span class="st">&quot;CL_ACTIVITY&quot;</span>)</a></code></pre></div>
<p>Since downloading codelists can take some time, any function that accesses online
SDMX registries will store the download in memory for the duration of the R session.</p>
<p>There is also a <code>estat_codelist()</code> function for downloading codelists from
the Eurostat SDMX registry.</p>
</div>
<div id="derive-rules-from-dsd" class="section level2">
<h2><span class="header-section-number">9.4</span> Derive rules from DSD</h2>
<p>The functions described in the previous subsection allow you to check
variables against a particular SDMX code list. It is also possible to
download a complete Data Structure Definition and generate all checks
implied by the DSD.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb271-1" title="1">rules &lt;-<span class="st"> </span><span class="kw">validator_from_dsd</span>(<span class="dt">endpoint =</span> <span class="kw">sdmx_endpoint</span>(<span class="st">&quot;ESTAT&quot;</span>)</a>
<a class="sourceLine" id="cb271-2" title="2">   , <span class="dt">agency_id =</span> <span class="st">&quot;ESTAT&quot;</span>, <span class="dt">resource_id =</span> <span class="st">&quot;STSALL&quot;</span>, <span class="dt">version=</span><span class="st">&quot;latest&quot;</span>)</a>
<a class="sourceLine" id="cb271-3" title="3"></a>
<a class="sourceLine" id="cb271-4" title="4"><span class="kw">length</span>(rules)</a>
<a class="sourceLine" id="cb271-5" title="5">[<span class="dv">1</span>] <span class="dv">13</span></a>
<a class="sourceLine" id="cb271-6" title="6">rules[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb271-7" title="7">Object of class <span class="st">&#39;validator&#39;</span> with <span class="dv">1</span> elements<span class="op">:</span></a>
<a class="sourceLine" id="cb271-8" title="8"><span class="st"> </span>CL_FREQ<span class="op">:</span><span class="st"> </span>FREQ <span class="op">%in%</span><span class="st"> </span><span class="kw">sdmx_codelist</span>(<span class="dt">endpoint =</span> <span class="st">&quot;https://ec.europa.eu/tools/cspa_services_global/sdmxregistry/rest&quot;</span>, <span class="dt">agency_id =</span> <span class="st">&quot;SDMX&quot;</span>, <span class="dt">resource_id =</span> <span class="st">&quot;CL_FREQ&quot;</span>, <span class="dt">version =</span> <span class="st">&quot;2.0&quot;</span>)</a>
<a class="sourceLine" id="cb271-9" title="9">Rules are evaluated using locally defined options</a></code></pre></div>
<p>There are 13 rules in total. For brevity, we only sho the first rule here.
Observe that the first rule checks the variable <code>CL_FREQ</code> against a code list
that is retrieved from the global SDMX registry. A demonstration of the fact
that in a DSD does not have to be fully self-contained and can refer to
metadata in other standard registries. If a data set is checked against this
rule, <code>validate</code> will download the codelist from the global registry and
compare each value in column <code>CL_FREQ</code> against the codelist.</p>
<p>Note that the <code>validator_from_dsd</code> function adds relevant metadata such as a
rule name, the origin of the rule and a short description. Try</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb272-1" title="1">rule[[<span class="dv">1</span>]]</a></code></pre></div>
<p>to see all information.</p>
</div>
<div id="moresdmx" class="section level2">
<h2><span class="header-section-number">9.5</span> More on <code>SDMX</code></h2>
<p>The Statistical Data and Metadata eXchange (<a href="https://sdmx.org">SDMX</a>) standard
is an ISO standard designed to facilitate the exchange or dissemination of
<a href="https://en.wikipedia.org/wiki/Official_statistics#:~:text=Official%20statistics%20are%20statistics%20published,organizations%20as%20a%20public%20good.">Official
Statistics</a>.
At the core it has a logical information model describing the key
characteristics of statistical data and metadata, which can be applied to any
statistical domain. Various data formats have been defined based on this
information model, such as SDMX-<a href="https://tools.ietf.org/html/rfc4180">CSV</a>,
SDMX-<a href="https://www.json.org/json-en.html">JSON</a>), and - by far the most widely
known - SDMX-ML (data in <a href="https://www.w3.org/XML/">XML</a>). A key aspect of the
SDMX standard is that one defines the metadata, including data structure,
variables, and code lists beforehand in order to describe what data is shared
or published. This metadata is defined in an <em>SDMX registry</em> where data
producers can download or query the necessary metadata. Alternatively metadata
is distributed in a so-called <em>Data Structure Definition</em> (DSD) file, which is
usually an XML format. Both types of modes should result in exactly the same
metadata agreements.</p>
<p>SDMX registries can be accessed through a <a href="https://en.wikipedia.org/wiki/Representational_state_transfer">REST
API</a>, using a
standardized set of parameters. We can distinguish between registries
that provide metadata and registries that provide the actual data.
For the validate package, the metadata registries are of interest. Some of
widely used metada registries include the following.</p>
<ul>
<li><a href="https://registry.sdmx.org/">Global SDMX Registry</a>: for global metadata,
hosted by the SDMX consortium. The central place for ESS-wide metadata. This
registry hosts important statistical metadata such as for CPI/HICP, National
Accounts (NA), Environmental accounting (SEEA), BOP, GFS, FDI and many more.
Unfortunately not all ESS metadata is present in this registry.</li>
<li><a href="https://webgate.ec.europa.eu/sdmxregistry/">Eurostat SDMX Registry</a>: for
Eurostat-wide metadata, hosted by Eurostat. This registry contains statistical
metadata for all other official statistics in the European Statistical System
(ESS). Access is offered via SDMX 2.1 REST API.</li>
<li><a href="https://sdmxcentral.imf.org/overview.html">IMF SDMX Central</a>: Registry by
the IMF.</li>
<li><a href="https://sdmx.data.unicef.org/">UNICEF</a>: Registry by UNICEF</li>
</ul>
<p>Organisations that at the time of writing (summer 2021) actively offer
automated access to their data (not just metadata) via an SDMX API include
the European Central Bank (<a href="https://sdw-wsrest.ecb.europa.eu/help/">ECB</a>),
the <a href="https://data.oecd.org/api/">OECD</a> (in
<a href="https://data.oecd.org/api/sdmx-json-documentation/">SDMX-JSON</a> or
<a href="https://data.oecd.org/api/sdmx-ml-documentation/">SDMX-ML</a> format),
<a href="https://ec.europa.eu/eurostat/web/sdmx-web-services/rest-sdmx-2.1">Eurostat</a>,
the International Labour Organisation (<a href="https://www.ilo.org/sdmx/index.html">ILO</a>),
the UN Food and Agriculture Organization
(<a href="http://api.data.fao.org/1.0/esb-rest/sdmx/introduction.html">FAO</a>),
the <a href="https://datahelpdesk.worldbank.org/knowledgebase/articles/1886701-sdmx-api-queries">Worldbank</a>,
the Bank for International Settlements
(<a href="https://www.bis.org/statistics/sdmx_techspec.htm?accordion1=1&amp;m=6%7C346%7C718">BIS</a>),
and the Italian Office of National Statistics (<a href="https://www.istat.it/it/metodi-e-strumenti/web-service-sdmx">ISTAT</a>).
The SDMX consortium does not maintain a list of active SDMX endpoints. The
<a href="https://cran.r-project.org/package=rsdmx">rsdmx R package</a> maintains such a
list based on an earlier inventory of Data Sources, but at the time of writing
not all those links appear to be active.</p>
<p>Ideally, all SDMX providers would have implemented SDMX in a coordinated way so
that a client looking for SDMX metadata to validate its data before sending
could query the respective sources using one and the same API. The latest
version of the REST API is 2.1 which is described very well in the easy to use
<a href="https://raw.githubusercontent.com/sdmx-twg/sdmx-rest/master/v2_1/ws/rest/docs/rest_cheat_sheet.pdf">SDMX API cheet
sheet</a>.
Inspecting the endpoints shows that not all providers implement all same
resource values. Depending on the provider an organization may decide which
elements of the API are exposed. For example, the API standard defines methods
to retrieve code lists from a DSD, but this functionality may or may not be
offered by an API instance. If it is not offered, this means the client
software needs to retrieve this metadata via other resource requests or
alternatively extract them locally from a DSD file. Finally we signal that on
a technical level the API of the various institutes may differ considerably and
that not all SDMX services implement the same version of SDMX.</p>
<p>This means that users should typically familiarize themselves somewhat with the
specific API they try to access (e.g. from <code>validate</code>).</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sect-rulefiles.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sect-comparing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["validatecookbook.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
